@{
    ViewBag.Title = GlobalAppSettings.SystemSettings.OrganizationName + " - [[[Administration]]]";
    ViewBag.MessageBox = false;
}

@section styles{
    @Styles.Render("~/styles/admin/site-settings")
}

@section scripts{

<script>
    serverApp.controller("adSettingsController", ["$scope", function($scope) {
        $scope.regex = '^(?!(ftp|https?):\/\/)([a-zA-Z0-9-_]+\.)*[a-zA-Z0-9][a-zA-Z0-9-]+(\.[a-z]{2,6})?(:\d{1,5})?(\/[a-zA-Z0-9]+[a-zA-Z0-9]*(\.[a-z]{2,8})?)*?$';
        $scope.distinguishedNameRegex = /^(\w+[=]{1}[a-zA-Z0-9-_\s]+)([\,{1}]\w+[=]{1}[a-zA-Z0-9-_\s]+)*$/;
    }]);
    
</script>

<script type="text/javascript">

    var SystemSettingsProperties = @Html.Raw(Json.Encode(ViewBag.SystemSettings));
    var fileUploadUrl = "@Url.Action("Upload", "fileupload")";
    var updateSystemSettingsUrl = "@Url.Action("UpdateSystemSettings", "Administration")";
    var updateUmsSettingsUrl = "@Url.Action("UpdateUmsSettings", "Administration")";
    var umsTestConnectionUrl  = "@Url.Action("UMSTestConnection", "Administration")";
    var setLanguageUrl = "@Url.Action("SetLanguage", "Administration")";
    var baseRootUrl = "@Url.Content("~/")";
    if (baseRootUrl.toLowerCase() === "/")
        baseRootUrl = "";

    $(function() {
        if ("@ViewBag.scheme.ToLower()" != "null") {
            $("#enable-ssl").val("@ViewBag.scheme");
        } else {
            $("#enable-ssl").val("http");
        }
        $("#enable-ssl").selectpicker("refresh");

        $(document).click(function(e){
            if (e.target.id !== "error_icon") {
                $("#ssl-help-message").hide();
            }
        });
    });
</script>

    <script type="text/javascript">

        $(document)
            .ready(function() {
                var section = window.location.href;
                $(".system-settings-sidebar li").hide();

                if (section.toLowerCase().indexOf("groups") > 0 ||
                    section.toLowerCase().indexOf("users") > 0 ||
                    section.toLowerCase().indexOf("user-management") > 0) {
                    $("li[data-current-content='groups'],li[data-current-content='users']").show();
                } else {
                    $("li[data-current-content='emailsettings'],li[data-current-content='general'],li[data-current-content='activedirectorysettings'],li[data-current-content='notificationsettings'],li[data-current-content='licensesettings']").show();
                }
                if (section.toLowerCase().indexOf("groups") > 0) {
                    $("li[data-current-content='groups'] a").addClass('active');
                } else if (section.toLowerCase().indexOf("users") > 0 ||
                    section.toLowerCase().indexOf("user-management") > 0) {
                    $("li[data-current-content='users'] a").addClass('active');
                } else if (section.toLowerCase().indexOf("e-mail-settings") > 0) {

                    $("li[data-current-content='emailsettings'] a").addClass('active');
                    $("#look-and-feel-container, #active-directory-container").hide();
                    $("#mail-settings-container").show();
                } else if (section.toLowerCase().indexOf("user-directory-settings") > 0) {

                    $("li[data-current-content='activedirectorysettings'] a").addClass('active');
                    $("#look-and-feel-container, #mail-settings-container").hide();
                    $("#active-directory-container").show();
                } else if (section.toLowerCase().indexOf("notification-settings") > 0) {
                    $("li[data-current-content='notificationsettings'] a").addClass('active');
                } else if (section.toLowerCase().indexOf("license-settings") > 0) {
                    $("li[data-current-content='licensesettings'] a").addClass('active');
                    $("#mail-settings-container, #active-directory-container").hide();
                } else {
                    $("li[data-current-content='general'] a").addClass('active');
                    $("#look-and-feel-container").show();
                    $("#mail-settings-container, #active-directory-container").hide();
                }
                $("#schedule-synchronization").tooltip();
            });
    </script>


    @Scripts.Render("~/scripts/admin/site-settings")
}

@section MainSection{
    @Html.Partial("_AdminMenu")

    @Html.Partial("_SiteSettings")

    @Html.Partial("_EmailSettings")

    @Html.Partial("_ActiveDirectorySettings")
}